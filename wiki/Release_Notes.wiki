#summary Tungsten Replicator Release Notes
#labels Featured
<wiki:toc max_depth="4" />
= Tungsten Replicator Release Notes =

== Introduction ==

This page contains release notes for Tungsten Replicator open source releases. 

== Tungsten Replicator 2.0.7 ==

TODO: Robert to post a summarizing paragraph here.

Issue 232 - Replication from MySQL to Oracle drops UPDATE statements silently when table lacks primary key

Issue 258 - Statement transactions lack SQL parsing metadata for filtering after they are logged

Issue 270 - Problems running installer on Solaris

Issue 304 - Replicator hangs on connection to dead network interface

Issue 323 - UPDATEs and DELETEs on a slave which update zero rows should fail

Issue 370 - Add support for CVS batch loading using external utilities like Calpont cpimport

Issue 371 - Parallel replication may lock up intermittently when Amazon instances are too small

Issue 374 - Implement purge operation

Issue 382 - Replication commits partial transaction following application error or OutOfMemory condition

Issue 386 - Add support for fast batch loading using direct inserts and minimal staging table for deletes

Issue 396 - Add option to make replicators read preferentially from a slave rather than a master

Issue 397 - Replicator has problems finding filtered events in log, leading to slave restart failures

Issue 398 - options for mysqldump backup are non-transactional safe

Issue 401 - Channel assigments for round-robin selection are not cleared when replicator goes offline cleanly

Issue 405 - Add Tungsten Replicator Cookbook to the standard tarball

Issue 408 - Incorrect configuration of THL parameter causes potentially large memory usage

Issue 411 - tools/configure fails if the $CONTINUENT_ROOT/tungsten directory already exists and is empty

Issue 414 - Parallel apply may stop replicating databases if channel number is adjusted after unclean restart

Issue 416 - Slave replicator stalls when parallel replication is enabled with on-disk queues

Issue 417 - Table rename filter with regex support

Issue 421 - Add filter to convert MySQL zero dates to null value

Issue 422 - Omit installation of parallel queues when 'none' is the replication type

Issue 424 - Filter to generate change rows for incoming transactions

Issue 425 - Enable Tungsten replication into Amazon RDS slave

Issue 426 - Add relative latency to enable users to tell when replicator is stalled or slave may be out of date

Issue 430 - Position reported as -1

Issue 431 - Implement ./ddlscan utility for flexible schema transformations

Issue 433 - NULL values ini extract_timestamp or update_timestamp cause NPE

Issue 434 - The xtrabackup-incremental script fails if $CONTINUENT_ROOT/backups/xtrabackup doesn't exist

Issue 440 - tungsten does not read variables with underscores

Issue 442 - BidiRemoteSlaveFilter fails with NullPointerException on filtered events

Issue 443 - shardfilter does not fail replication on wrong shard

Issue 445 - Tungsten installation fails with MySQL 5.6

Issue 446 - Tungsten installer MySQL 5.6 checksum awareness

Issue 448 - The xtrabackup methods ignore innodb_data_home_dir and innodb_log_group_home_dir

Issue 449 - SetToStringFilter to convert SET to a VARCHAR list

Issue 456 - Reduce the output of tools/configure and tools/configure-service

Issue 457 - Consistency checking fails on keyword-named columns

== Tungsten Replicator 2.0.6 ==

This release includes the first working implementation of batch loading for data warehouses, focusing on Vertica.  It also includes substantial improvements to parallel replication including fixes for bugs that caused replicator freezes as well as problems with serialization in large data sets.  There are minor improvements to enhance multi-master replication as well as a number of general fixes that improve performance and robustness of the replicator as a whole, especially when processing large transactions.  Finally, this release adds support for MySQL to Oracle as well as MySQL to PostgreSQL replication.  

You should be able to upgrade from Tungsten Replicator 2.0.5 using the tools/update command.  See the official documentation at https://docs.continuent.com/wiki/display/TEDOC/Tungsten+Documentation+Home, for instructions on upgrade.  Starting with this and future releases, replicator documentation is shifting to a new home on the Continuent website.  It is our goal to provide very complete documentation of replicator operation.  

Issue 8 - Race condition when a DDL statement is immediately followed by a DML statement on the same object   Durability	 

Issue 39 - Auto-commit DDL statements break block commit   Durability	 

Issue 51 - PostgreSQL Slony Log Extractor: POC	 

Issue 90 - waitForAppliedSequenceNumber can return before the sequence number event was actually committed	 

Issue 129 - Certify MySQL->PostgreSQL support  

Issue 168 - MySQL extractor is slow due to large number of calls to slow disk metadata commands	 

Issue 172 - './trepctl online -from-event' is dangerous	 

Issue 181 - Parallel replication does not use all channels	 

Issue 183 - Clean up code, unit tests, and build scripts to speed up builds and eliminate warnings and/or hung builds	 

Issue 238 - Implement an applier for Vertica data warehouse	 

Issue 256 - Master replicator unable to connect to MariaDB 5.2.9 after installation	 

Issue 291 - DROP TABLE loops in multi-master environment on MYSQL 5.5	 

Issue 299 - Installer support for AWS EC2 Linux	 

Issue 305 - Add installation support for logging slave updates	 

Issue 308 - Tungsten generates warning and skips prefetch on rows that contain MySQL "zero" dates of the form '0000-00-00 00:00:00'	 

Issue 317 - Filters should not drop parts of fragmented events, and even less the last fragment	 

Issue 328 - When reconnecting, slaves do not close sockets for connection to master if the master goes away/offline, leading to file descriptors leak.	 

Issue 330 - configure_deployment_handler.rb uses -C option for rsync, *.so files fail to be copied during installation	 

Issue 333 - Tungsten does not correctly compute restart point after restore of hot backup on slave with parallel apply enabled	 

Issue 334 - Unable to restore the same backup to a slave and then a slave of a slave	 

Issue 336 - EnumToString filter URL is not properly configured with MySQL schema name	 

Issue 339 - In row replication, NULL blobs are badly handled and can lead to 'java.sql.SQLException: You need to set exactly X parameters on the prepared statement' when applied on slave	 

Issue 343 - Remove FSM (Finite State Machine) library source code and use JAR instead	 

Issue 346 - Add support for round-robin THL connection using a list of THL URLs instead of a single THL	 

Issue 355 - Oracle UPDATEs that change no columns lead to OptimizeUpdatesFilter removing too much   

Issue 359 - Clean-up : remove classes in Commons project that are not needed by Tungsten Replicator   

Issue 360 - Pipeline locks up when attempting to serialize #UNKOWN shard using disk parallel queue	 

Issue 362 - Installer support for round-robin THL connection list	 

Issue 364 - Option for applier to use column names from the underlying THL event	 

Issue 368 - tungsten-installer ability to install master extracting from a remote DBMS	 

Issue 372 - Add Oracle event ID type	 

Issue 373 - trepctl online -from-event does not work from slave	 

Issue 376 - OpenReplicatorManager doesn't have correct Method Descriptions	 

Issue 377 - Tungsten replicator generates a large number of build warnings	 

Issue 378 - Parallel replication locks up when waiting for #UNKOWN transaction to commit	 

Issue 380 - JMX configuration file misses the database port in its "resourceJdbcUrl"	 

Issue 381 - Timestamp value of 0 fails to replicate on MySQL when using row replication.	 

Issue 383 - Add support for an incremental xtrabackup method	 

Issue 384 - Tungsten generates invalid SQL when updating DROP TABLE statements to prevent replication loops	 

Issue 385 - Protobuf fails to deserialize events that are too large (more than 64MB)	 

Issue 387 - Replication has excessive latency in recent versions	 

Issue 389 - Replicator default heap size is too low	 

Issue 390 - replicator does not commit large RBR transactions   Usability	 

Issue 392 - Replicator hangs on large transactions with multiple fragments	 

Issue 393 - installer accepts invalid option --log-slave instead of --log-slave-updates
	 
Issue 394 - Rename Tungsten commons library and Eclipse projects

== Tungsten Replicator 2.0.5 ==

This release improves overall replication capabilities by fixing a number of bugs that affected stability of replication in production environments and increases robustness of parallel replication, which now clocks in at 4-5 times MySQL native replication performance.  It also includes robust installation commands for MongoDB and Oracle slaves.  There is a working prefetch applier available.  Finally, a draft batch load capability is available.  (See Issue 238 for more information; Vertica will be fully supported in the next replicator release.) 

Unlike previous releases there should be minimal issues with upgrade.  Tungsten 2.0.5 should be fully interoperable with Tungsten 2.0.4.  Note that there may be occasional changes in options used by tungsten-installer. Check 'tungsten-installer --help-all -a' for currently supported settings. 

Issue 17 - `./trepctl stop` doesn't stop the Replicator process

Issue 67 - tungsten-installer does not detect already installed instances

Issue 73 - trepctl status does not show the host name and RMI port 

Issue 74 - Null point exception when thl is used on an empty file after installing in --direct mode 

Issue 88 - trepctl services does not display the latest sequence number with parallel replication

Issue 147 - Enable THL to regenerate itself after an error

Issue 148 - Enable backwards propagation of purge points 

Issue 149 - Enable round-robin assignment of shards to channels.

Issue 152 - Support direct extract of MySQL binlog across network

Issue 153 - Improve usability of message logs.

Issue 174 - `./trepctl online -seqno X` leads to deferred offline request

Issue 186 - Installation fails on master only.

Issue 189 - date 0000:00:00 does not replicate in ROW binlog format correctly.

Issue 200 - Tungsten Replicator removes log files before their contents are processed

Issue 201 - Purging all records from log using 'thl purge' hangs replication service

Issue 210 - tungsten installer does not recognize "~" as $HOME 

Issue 217 - Regression: Installation fails with error concerning backup methods

Issue 218 - Extractor error during flush JMX call causes replicator to hang 

Issue 220 - tungsten-installer --property can't insert an empty property

Issue 221 - thl list assumes 0 as lower seqno in every file

Issue 226 - Add 'version' to trepctl help

Issue 229 - Implement installation support for MySQL to MongoDB replication

Issue 231 - Installation does not support log fsync settings that are fully crash-safe

Issue 233 - Offline operation is very slow on slaves running parallel apply

Issue 235 - MySQL event extraction fails intermittently when using relay log downloading

Issue 239 - Improve DatabaseTransformFilter in order to handle more than one regular expression

Issue 240 - Installer should check replicator JMX ports are not boundIssue 

Issue 241 - Develop generic infrastructure for testing replication within and across DBMS types

Issue 245 - TableMapLogEvent are badly extracted for table with large number of columns

Issue 248 - OptimizeUpdatesFilter can fail with NPEIssue 249 - Docs: add `which` to prerequisites

Issue 251 - Slave restart may fail if the last applied transaction was from a filtered event

Issue 252 - CatalogManager does not correctly set the session log level

Issue 254 - ReplicateFilter gets NullPointerException if a filter string is omitted

Issue 255 - Add a new applier that can be used to prefetch data into database cache

Issue 257 - Replicator may fail to process binlog files that are more than 2 GB large

Issue 259 - Direct pipeline start-up after clearing logs fails 

Issue 260 - Building with OpenJDK 7 Fails in DiagnosticWizard.java (sun.management.ManagementFactory is not publicâ€¦)

Issue 265 - Requirements are not complete (rsync missing)

Issue 267 - MySQL extraction fails on binlog file open when using using relay log downloading

Issue 269 - THLStorageCheck breaks multiple master installation

Issue 272 - Infinite loop in options parsing in `configure-service`

Issue 290 - Replicator fails to delete temp files on slaves when processing LOAD DATA LOCAL INFILE

Issue 295 - Using Load Data Infile into temporary table breaks replication

Issue 297 - Enable slave replicators to restart from a specific event ID on the master


== Tungsten Replicator 2.0.4 ==

This release contains greatly improved parallel replication capabilities including high-performance on-disk queues, a production quality single-command install, and new features to support multi-master replication using the system-of-record model.  In addition, there are numerous bug fixes.  

This release requires careful attention to upgrade due to the following changes: 

 # *Installation procedures* have changed substantially.  The old tungsten.cfg is not compatible with the new tungsten.cfg file format, which is JSON-based. The new installation uses *./tools/tungsten-installer*, which is also a validation tool.
 # Installing a direct slave (useful for parallel replication) is simpler and straightforward. Taking over from MySQL native replication and handing back over to the old slave is also easy. 
 # The *trep_commit_seqno* table includes additional columns.  The table can be upgraded by running {{{ALTER TABLE `trep_commit_seqno` ADD COLUMN `shard_id` VARCHAR(128) NULL DEFAULT NULL; ALTER TABLE `trep_commit_seqno` ADD COLUMN `extract_timestamp` TIMESTAMP NULL DEFAULT NULL;}}}
 # There is a new *trep_shard* table that can be created by running {{{CREATE TABLE `trep_shard` ( `name` varchar(128) NOT NULL DEFAULT '', `master` varchar(128) DEFAULT NULL, `critical` tinyint(4) DEFAULT NULL, PRIMARY KEY (`name`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8}}}
 # The replicator logs are now integrated by a *user.log*, a more concise and user friendly log.
 # The installation tools can handle all values in the properties file. In addition to being a single-command installation, the procedure can also customize the replicator properties from the start.

Logs and other data structures should be backwards compatible.  However, due to the nature of these changes we recommend for the safest upgrade that you stop traffic on the master server, quiesce replication fully, delete existing THL logs as well as tungsten_svcname databases, then restart with new version 2.0.4 installations.  

The change in installations is a one-time occurrence that is necessary to provide better installation procedures that are fully scriptable.  

Issue 28 - Upgrade THL to use buffered I/O 

Issue 36 - Single command setup for replication   

Issue 42 - Tungsten-replicator duplicates tarball expanded directory

Issue 71 - Enhance THL durability against failures

Issue 82 - Implement THL ParallelQueue Support, aka on-disk queues

Issue 83 - Trepctl should take the RMI port from configuration files

Issue 93 - Duplicate issues in static-servicename.properties

Issue 97 - Mysqldump options are not optimal

Issue 98 - Properties file uses hardcoded file names for backup and other        

Issue 99 - Tungsten installer does not detect running MySQL native replication   

Issue 102 - Implement shard control API

Issue 103 - Replicator parsing for MySQL has a number of missing cases that result in large numbers of #UNKNOWN shards

Issue 106 - MySQL extractor fails to extract server_id value from first transaction in new binlog file

Issue 109 - Slave replicator loses track of position after a process restart     

Issue 113 - Tungsten installer detects privileges for the wrong user

Issue 117 - Report null values distinctly in `./thl list` output          

Issue 120 - Fix issues identified by RandomQueryGenerator tests

Issue 122 - PrimaryKeyFilter throws NullPointerException if it can't find the table  

Issue 124 - UPDATE multiple rows with different values in a single SQL leads to inconsistency   

Issue 125 - Tungsten-installer fails on Ubuntu 9.10      

Issue 126 - Merge Greenplum support            

Issue 130 - Tools/tungsten-installer does not issue warnings when the master-host is incorrect   

Issue 133 - Make replicator use relay logs as their default      

Issue 138 - Tungsten-installer should be able to accept properties values        

Issue 140 - Tungsten-installer issues confusing error about server ID if MySL login credentials are wrong        

Issue 141 - Tools/configure-service does not update services             

Issue 142 - Tungsten-installer :: Ruby issues :: NilClass (NoMethodError)        

Issue 146 - Tungsten-installer hangs when there is a non-breaking space in the command arguments         

Issue 151 - Enable seamless migration from and to MySQL replication   Sponsored            

Issue 159 - Flush operation does not return the right sequence number (returns the last but one)         

Issue 160 - DatabaseTransformFilter fails with NullPointerException if an event does not have a default schema

Issue 164 - Merge MySQL->Oracle support           

Issue 167 - Broken installation in build 192   

Issue 169 - Trepctl offline is ignored in some states, such as during replicator synchronization with master   

Issue 170 - Shard status list does not show latency correctly            

Issue 173 - `./trepctl online-skip z` doesn't wait for events to be received               

Issue 176 - Slave replicator does not reliably reconnect when master IP goes down or moves to another host       

Issue 177 - On-disk queues fail due to apparent race condition but do not stop the replicator            

Issue 180 - Parallel queues are not crash safe

Issue 182 - Tungsten-installer fails master/slave validation if OpenJDK is installed

Issue 184 - Race condition at start-up of THLParallelQueue causes intermittent pipeline failure

Issue 190 - Tungsten slave fails when restarting on clean logs after reloading a dump

Issue 196 - PostgreSQL streaming replication management fails on start-up        

Issue 198 - Tungsten Replicator retention option does not purge logs

Issue 199 - Tungsten-installer --help-all command hangs on Ubuntu

Issue 202 - Configure-service concatenates properties

Issue 203 - Slave replicator incorrectly commits following lock wait timeout

Issue 205 - Heterogeneous installer: do not transfer strings as bytes

Issue 206 - Tungsten-installer does not check for binlog being enabled.          

Issue 207 - Tungsten installer does not parse --native-slave-takeover correctly  

Issue 208 - Tungsten-installer does not detect the server-id correctly

Issue 209 - Inserting data into a myisam table with auto_increment primary key breaks multi master replication

== Tungsten Replicator 2.0.3 ==

This release contains a beta version of the new command line installer, a prototype applier for MySQL to MongoDB replication, and numerous bug fixes.   

Logs and other data structures should be backwards-compatible with version 2.0.2.  If you run into log compatibility problems, please log them as bugs.  If in doubt, quiesce the master(s), allow all slaves to catch up, and clear THL files before upgrading.  

Issue 18 - Tungsten replicator with binary support enabled fails on MySQL 5.5   

Issue 22 - Missing option in configure script to set RMI port

Issue 23 - Missing options to set the applier in configure-service

Issue 24 - Replicator start in sandbox fails due to non-standard ports

Issue 25 - Provide JSON scripting API for replicator             

Issue 29 - Replication failure after long delay between queries...

Issue 30 - WARNING from running trepctl services         

Issue 32 - Tungsten slaves react poorly when they cannot obtain needed sequence number from master 

Issue 34 - Use buffered I/O more effectively when extracting from MySQL binlog

Issue 35 - Clean up Tungten release directory structure

Issue 37 - Tungsten Replicator fails to extract from MySQL 5.5 binlog if clients use utf8mb4 character set

Issue 38 - THL connection URL is not set correctly when using off-board replication

Issue 41 - tungsten-installer does not check if a given directory name is a regular file

Issue 43 - Installation fails with tungsten-installer

Issue 44 - tungsten-installer does not accept --verbose, no-validation and --validate-only unless they are on top

Issue 45 - tungsten-installer creates directories without asking and without options to modify the defaults

Issue 46 - tungsten-installer missing option : --start

Issue 47 - Option names for the same thing should be common to all modes and have a unique name

Issue 48 - tungsten-installer does not check that master and slave have different sources

Issue 49 - Missing option in tungsten-installer in --direct-mode for master-log-directory and master-log-pattern

Issue 50 - tungsten-installer does not require slave-password as mandatory

Issue 54 - Provide a filter that extracts table columns names on the extractor side

Issue 55 - Create Basic MongoDB Applier

Issue 56 - tungsten-installer help should be shortened

Issue 57 - tungsten-installer should not display the full help after an error

Issue 59 - Setting two slaves in direct role with the same master fails

Issue 64 - Add a check to ensure that a master replicator does not have unapplied data in its history log (THL)

Issue 65 - Unable to create RMI listener due to bad IP in /etc/hosts

Issue 68 - After using tungsten-installer with the --direct option, thl does not work 

Issue 69 - ./tools/configure fails when star with a custom made cfg file

Issue 70 - Merge improvements from Tungsten 1.3.x

Issue 72 - RMI port option is not applied

Issue 75 - tungsten-installer fails to notice that the replicator is already started

Issue 76 - Installer with --start-and-report fails to start correctly

Issue 84 - Add options for sandbox installation to master-slave   

Issue 91 - Provide version information for replicator in easy-to-find location

== Tungsten Replicator 2.0.2 ==

This release is our first full open source release and contains a couple of critical bug fixes for parallel and multi-master replication as well as a number of smaller fixes to correct problems with installations.  Logs and other data structures are backwards-compatible with version 2.0.1. 

Issue 1 - Clean up javadoc build warnings

Issue 2 - Configure script does not set up disk log

Issue 3 - Integrate Hudson build number to release tarball

Issue 5 - Replicator does not correctly assign #UNKNOWN shard when updates cross schema boundaries within a single transaction

Issue 6 - When using disk logs, thl list can show a NullPointerException error    

Issue 11 - Add a timestamp column into trep_commit_seqno table in order to know when this table was updated

Issue 15 - Some records get lost in multiple master replication    

Issue 19 - Thl unable to read disk log

Issue 20 - Need installation support for direct pipeline where master is on a remote host 


== Tungsten Replicator 2.0.1 ==

This release is a binary build from the enterprise sources prior to full open source release.  It is free for use while we are getting code properly merged to code.google.com.

  * TUC-211 - Slave replicator freezes after going online following master restart
  * TUC-249 - Replicator consistency checks fail with NullPointerException when replicator is offline
  * TUC-266 - Parallel apply performance is unexpectedly slow when using direct pipeline
  * TUC-267 - Tungsten Replicator tasks improperly commit current block on interruption, which causes a restart failure
  * TUC-268 - race condition with DDL immediately after Tungsten starts
  * TUC-269 - Possible loop with multi-master topology due to block commit
  * TUC-270 - Simple SQL sequence causes UNKNOWN shards
  * TUC-271 - Tungsten 2.0 installation does not work properly for off-board replication